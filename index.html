<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TempMail Shield | Simple Disposable Email</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #7c3aed;
            --primary-light: #8b5cf6;
            --primary-dark: #6d28d9;
            --secondary: #10b981;
            --dark: #1e293b;
            --darker: #0f172a;
            --darkest: #020617;
            --light: #f8fafc;
            --lighter: #f1f5f9;
            --danger: #ef4444;
            --success: #10b981;
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background-color: var(--darkest);
            color: var(--light);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
            width: 100%;
        }

        header {
            background-color: var(--darker);
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
        }

        .logo-icon {
            background-color: var(--primary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--light);
        }

        .logo-text span {
            color: var(--primary-light);
        }

        .hero {
            text-align: center;
            padding: 3rem 0;
            margin: 2rem 0;
        }

        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero p {
            font-size: 1.1rem;
            color: var(--lighter);
            max-width: 700px;
            margin: 0 auto 2rem;
            opacity: 0.9;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .step {
            background-color: var(--darker);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.25rem;
        }

        .step-number {
            background-color: var(--primary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .step-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .step-content {
            margin-left: calc(28px + 0.75rem);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background-color: rgba(255, 255, 255, 0.05);
            color: var(--light);
        }

        .btn-secondary:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .btn-success {
            background-color: var(--success);
        }

        .btn-success:hover {
            background-color: #0d9b6c;
        }

        .input-group {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .input-field {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.03);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.2s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.3);
        }

        .result-box {
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            border: 1px dashed rgba(255, 255, 255, 0.1);
            word-break: break-all;
        }

        .email-display {
            font-size: 1.1rem;
            font-weight: 500;
            color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .token-display {
            font-size: 0.9rem;
            color: var(--light);
            opacity: 0.8;
            margin-top: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .copy-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--light);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .copy-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .verification-code {
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            margin: 1.5rem 0;
            color: var(--success);
            background-color: rgba(16, 185, 129, 0.1);
            padding: 1.5rem;
            border-radius: 8px;
            letter-spacing: 0.1em;
        }

        .messages-container {
            margin-top: 1.5rem;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 0.5rem;
        }

        .message {
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.2s ease;
        }

        .message:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .message-sender {
            color: var(--primary-light);
        }

        .message-date {
            color: var(--light);
            opacity: 0.7;
            font-size: 0.8rem;
        }

        .message-subject {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--light);
        }

        .message-body {
            font-size: 0.9rem;
            color: var(--lighter);
            opacity: 0.9;
        }

        .empty-state {
            text-align: center;
            padding: 2rem;
            color: var(--light);
            opacity: 0.6;
            border: 1px dashed rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .empty-state i {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary);
            opacity: 0.5;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            padding: 0.25rem 0.75rem;
            border-radius: 999px;
            background-color: rgba(255, 255, 255, 0.05);
        }

        .status-indicator.active {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-indicator.inactive {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-dot.active {
            background-color: var(--success);
            box-shadow: 0 0 8px var(--success);
        }

        .status-dot.inactive {
            background-color: var(--danger);
            box-shadow: 0 0 8px var(--danger);
        }

        .auto-refresh {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
            color: var(--light);
            opacity: 0.7;
            margin-top: 1rem;
        }

        .token-input-container {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px dashed rgba(255, 255, 255, 0.1);
        }

        .token-input-label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
            color: var(--lighter);
            opacity: 0.8;
        }

        .token-input-wrapper {
            display: flex;
            gap: 0.5rem;
        }

        .token-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.03);
            color: var(--light);
            font-size: 0.9rem;
        }

        .token-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(124, 58, 237, 0.3);
        }

        .token-submit-btn {
            padding: 0 1.25rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .token-submit-btn:hover {
            background-color: var(--primary-dark);
        }

        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltip-text {
            visibility: hidden;
            width: 200px;
            background-color: var(--darker);
            color: var(--light);
            text-align: center;
            border-radius: 6px;
            padding: 0.5rem;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tooltip:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .spinner {
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .notification {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background-color: var(--darker);
            color: var(--light);
            padding: 0.75rem 1.25rem;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1000;
            border-left: 4px solid var(--primary);
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification.success {
            border-left-color: var(--success);
        }

        .notification.error {
            border-left-color: var(--danger);
        }

        footer {
            margin-top: auto;
            padding: 2rem 0;
            text-align: center;
            color: var(--light);
            opacity: 0.6;
            font-size: 0.875rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .hero p {
                font-size: 1rem;
            }
            
            .step {
                padding: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="#" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="logo-text">TempMail <span>Shield</span></div>
            </a>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <h1>Secure Disposable Emails</h1>
            <p>Protect your personal inbox from spam. Get instant temporary emails for sign-ups and verifications.</p>
        </section>

        <div class="app-container">
            <!-- Step 1: Generate Email -->
            <div class="step" id="step1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Create Your Temporary Email</div>
                </div>
                <div class="step-content">
                    <button id="generateEmailBtn" class="btn">
                        <i class="fas fa-plus-circle"></i>
                        <span id="generateBtnText">Generate Email Address</span>
                        <span id="generateSpinner" class="spinner" style="display: none;"></span>
                    </button>
                    
                    <div id="emailResult" class="result-box" style="display: none;">
                        <div class="email-display">
                            <span id="generatedEmail"></span>
                            <button class="copy-btn" onclick="copyToClipboard('generatedEmail', 'Email copied!')">
                                <i class="far fa-copy"></i> Copy
                            </button>
                        </div>
                        <div class="token-display">
                            <span>Your secret token: <span id="generatedToken"></span></span>
                            <button class="copy-btn" onclick="copyToClipboard('generatedToken', 'Token copied!')">
                                <i class="far fa-copy"></i> Copy
                            </button>
                        </div>
                    </div>

                    <div class="token-input-container">
                        <label class="token-input-label">Already have a token? Enter it below:</label>
                        <div class="token-input-wrapper">
                            <input type="text" id="tokenInput" class="token-input" placeholder="Paste your token here">
                            <button id="tokenSubmitBtn" class="token-submit-btn">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Use Email -->
            <div class="step" id="step2">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Use Your Temporary Email</div>
                </div>
                <div class="step-content">
                    <p style="margin-bottom: 1rem;">Copy the email above and use it for sign-ups. Your verification codes will appear below automatically.</p>
                    <div class="status-indicator inactive" id="emailStatus">
                        <div class="status-dot inactive"></div>
                        <span>Waiting for verification code...</span>
                    </div>
                </div>
            </div>

            <!-- Step 3: Get Verification Code -->
            <div class="step" id="step3">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Get Your Verification Code</div>
                </div>
                <div class="step-content">
                    <div id="verificationCodeContainer" style="display: none;">
                        <div class="verification-code" id="verificationCode"></div>
                        <button class="btn btn-success" onclick="copyToClipboard('verificationCode', 'Code copied!')">
                            <i class="far fa-copy"></i> Copy Verification Code
                        </button>
                    </div>
                    
                    <div id="messagesContainer">
                        <div class="empty-state" id="emptyInbox">
                            <i class="fas fa-inbox"></i>
                            <p>No messages yet. Your verification codes will appear here automatically.</p>
                        </div>
                        <div id="messagesList"></div>
                    </div>
                    
                    <div class="auto-refresh">
                        <i class="fas fa-sync-alt"></i>
                        <span>Auto-refreshing every 30 seconds</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>TempMail Shield &copy; 2023 | No registration required | Messages are automatically deleted</p>
        </div>
    </footer>

    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">Notification message</span>
    </div>

    <script>
        // API configuration
        const config = {
            TEMP_EMAIL_API: 'https://haji-mix-api.gleeze.com/api/tempgen',
            INBOX_API: 'https://haji-mix-api.gleeze.com/api/tempinbox',
            API_KEY: '68a1460c270fca56cb1f16fb0ca2fcfd170597b8a483de0568e6aac53ec08bbb',
            refreshInterval: 30000 // 30 seconds
        };

        // DOM elements
        const elements = {
            generateEmailBtn: document.getElementById('generateEmailBtn'),
            generateBtnText: document.getElementById('generateBtnText'),
            generateSpinner: document.getElementById('generateSpinner'),
            emailResult: document.getElementById('emailResult'),
            generatedEmail: document.getElementById('generatedEmail'),
            generatedToken: document.getElementById('generatedToken'),
            tokenInput: document.getElementById('tokenInput'),
            tokenSubmitBtn: document.getElementById('tokenSubmitBtn'),
            emailStatus: document.getElementById('emailStatus'),
            verificationCodeContainer: document.getElementById('verificationCodeContainer'),
            verificationCode: document.getElementById('verificationCode'),
            messagesContainer: document.getElementById('messagesContainer'),
            messagesList: document.getElementById('messagesList'),
            emptyInbox: document.getElementById('emptyInbox'),
            notification: document.getElementById('notification'),
            notificationText: document.getElementById('notificationText')
        };

        // State management
        const state = {
            currentToken: null,
            inboxInterval: null,
            lastEmailCount: 0
        };

        // Initialize the app
        function init() {
            // Check if we have a token in localStorage
            const savedToken = localStorage.getItem('tempMailToken');
            if (savedToken) {
                state.currentToken = savedToken;
                elements.generatedToken.textContent = savedToken;
                // We don't have the email, but we can still check inbox
                elements.emailResult.style.display = 'block';
                checkInbox();
                startInboxRefresh();
            }
            
            setupEventListeners();
        }

        // Set up event listeners
        function setupEventListeners() {
            elements.generateEmailBtn.addEventListener('click', generateTempEmail);
            elements.tokenSubmitBtn.addEventListener('click', useExistingToken);
            elements.tokenInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    useExistingToken();
                }
            });
        }

        // Generate temporary email
        async function generateTempEmail() {
            try {
                // Show loading state
                elements.generateBtnText.textContent = 'Generating...';
                elements.generateSpinner.style.display = 'inline-block';
                elements.generateEmailBtn.disabled = true;

                // Call API
                const response = await fetch(`${config.TEMP_EMAIL_API}?api_key=${config.API_KEY}`);
                const data = await response.json();

                if (data.email && data.token) {
                    // Update UI
                    elements.generatedEmail.textContent = data.email;
                    elements.generatedToken.textContent = data.token;
                    elements.emailResult.style.display = 'block';
                    
                    // Update state
                    state.currentToken = data.token;
                    localStorage.setItem('tempMailToken', data.token);
                    
                    // Start checking inbox
                    checkInbox();
                    startInboxRefresh();
                    
                    // Show success notification
                    showNotification('Temporary email created successfully!', 'success');
                    
                    // Update status indicator
                    updateEmailStatus('active');
                    
                    // Scroll to verification section
                    document.getElementById('step3').scrollIntoView({ behavior: 'smooth' });
                } else {
                    showNotification('Failed to generate email. Please try again.', 'error');
                }
            } catch (error) {
                console.error('Error generating temp email:', error);
                showNotification('An error occurred. Please try again.', 'error');
            } finally {
                // Reset button state
                elements.generateBtnText.textContent = 'Generate Email Address';
                elements.generateSpinner.style.display = 'none';
                elements.generateEmailBtn.disabled = false;
            }
        }

        // Use existing token
        function useExistingToken() {
            const token = elements.tokenInput.value.trim();
            if (!token) {
                showNotification('Please enter a valid token', 'error');
                return;
            }

            // Update state
            state.currentToken = token;
            localStorage.setItem('tempMailToken', token);
            
            // Update UI
            elements.generatedToken.textContent = token;
            elements.emailResult.style.display = 'block';
            elements.generatedEmail.textContent = 'Email address not available (using existing token)';
            
            // Start checking inbox
            checkInbox();
            startInboxRefresh();
            
            // Show success notification
            showNotification('Token applied successfully!', 'success');
            
            // Update status indicator
            updateEmailStatus('active');
            
            // Scroll to verification section
            document.getElementById('step3').scrollIntoView({ behavior: 'smooth' });
        }

        // Check inbox for messages
        async function checkInbox() {
            if (!state.currentToken) return;

            try {
                // Call API
                const response = await fetch(`${config.INBOX_API}?token=${state.currentToken}&api_key=${config.API_KEY}`);
                const messages = await response.json();

                if (messages && Array.isArray(messages)) {
                    displayMessages(messages);
                    
                    // Update last email count for change detection
                    state.lastEmailCount = messages.length;
                } else if (messages && messages.error) {
                    showNotification(messages.error, 'error');
                }
            } catch (error) {
                console.error('Error checking inbox:', error);
            }
        }

        // Display messages in inbox
        function displayMessages(messages) {
            // Hide empty state if we have messages
            elements.emptyInbox.style.display = messages.length ? 'none' : 'block';
            
            // Clear previous messages
            elements.messagesList.innerHTML = '';
            elements.verificationCodeContainer.style.display = 'none';

            // Process each message
            messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = 'message';
                
                // Try to extract verification code from subject
                const codeMatch = extractVerificationCode(message.subject);
                if (codeMatch) {
                    elements.verificationCode.textContent = codeMatch;
                    elements.verificationCodeContainer.style.display = 'block';
                    
                    // Update status indicator
                    updateEmailStatus('success');
                }
                
                // Format date
                const messageDate = message.date ? new Date(message.date).toLocaleString() : 'Unknown date';
                
                messageElement.innerHTML = `
                    <div class="message-header">
                        <span class="message-sender">${message.from || 'Unknown sender'}</span>
                        <span class="message-date">${messageDate}</span>
                    </div>
                    <div class="message-subject">${message.subject || 'No subject'}</div>
                    <div class="message-body">${message.body || 'No content'}</div>
                `;
                
                elements.messagesList.appendChild(messageElement);
            });
            
            // If we found new messages, show notification
            if (messages.length > state.lastEmailCount) {
                showNotification(`New message received!`, 'success');
            }
        }

        // Extract verification code from text
        function extractVerificationCode(text) {
            if (!text) return null;
            
            // Common patterns for verification codes
            const patterns = [
                /\b\d{4,8}\b/, // 4-8 digit code
                /code:?\s*(\d{4,8})/i,
                /verification:?\s*(\d{4,8})/i,
                /(\d{4,8})\s+is your verification code/i
            ];
            
            for (const pattern of patterns) {
                const match = text.match(pattern);
                if (match) {
                    return match[1] || match[0];
                }
            }
            
            return null;
        }

        // Start auto-refresh of inbox
        function startInboxRefresh() {
            // Clear any existing interval
            if (state.inboxInterval) {
                clearInterval(state.inboxInterval);
            }
            
            // Set up new interval
            state.inboxInterval = setInterval(() => {
                checkInbox();
            }, config.refreshInterval);
        }

        // Update email status indicator
        function updateEmailStatus(status) {
            const statusElem = elements.emailStatus;
            
            statusElem.classList.remove('active', 'inactive', 'success');
            statusElem.querySelector('.status-dot').classList.remove('active', 'inactive', 'success');
            
            switch (status) {
                case 'active':
                    statusElem.classList.add('active');
                    statusElem.querySelector('.status-dot').classList.add('active');
                    statusElem.querySelector('span').textContent = 'Waiting for verification code...';
                    break;
                case 'success':
                    statusElem.classList.add('success');
                    statusElem.querySelector('.status-dot').classList.add('active');
                    statusElem.querySelector('span').textContent = 'Verification code received!';
                    break;
                default:
                    statusElem.classList.add('inactive');
                    statusElem.querySelector('.status-dot').classList.add('inactive');
                    statusElem.querySelector('span').textContent = 'Waiting for email generation...';
            }
        }

        // Copy text to clipboard
        function copyToClipboard(elementId, message = 'Copied to clipboard!') {
            const element = document.getElementById(elementId);
            const text = element.textContent || element.innerText;
            
            navigator.clipboard.writeText(text).then(() => {
                showNotification(message, 'success');
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                showNotification('Failed to copy text', 'error');
            });
        }

        // Show notification
        function showNotification(message, type = 'info') {
            elements.notificationText.textContent = message;
            elements.notification.className = `notification ${type}`;
            elements.notification.classList.add('show');
            
            // Set icon based on type
            const icon = elements.notification.querySelector('i');
            icon.className = type === 'error' ? 'fas fa-exclamation-circle' : 'fas fa-check-circle';
            
            // Hide after 3 seconds
            setTimeout(() => {
                elements.notification.classList.remove('show');
            }, 3000);
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
